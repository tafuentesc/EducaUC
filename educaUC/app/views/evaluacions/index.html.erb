<%- model_class = Evaluacion -%>
<div class="page-header">
  <h1><%=t '.title', :default => "Evaluaciones" %></h1>
</div>
<table class="table">
  <thead>
    <tr>
      <th><%= model_class.human_attribute_name(:nombre_sala) %></th>
      <th><%= model_class.human_attribute_name(:fecha_de_evaluacion) %></th>
      <th><%= model_class.human_attribute_name(:encargado) %></th>
      <th><%= model_class.human_attribute_name(:estado) %></th>
      <th>Centro</th>
      <th><%=t '.actions', :default => t("helpers.actions") %></th>
    </tr>
  </thead>
  <tbody>
  <% if(@logged_user.admin?) %>
    <% @pendientes.each do |evaluacion| %>
      <tr class="record" data-class= "evaluaciones" data-id="<%= evaluacion.id %>">
        <td><%= evaluacion.nombre_sala %></td>
        <td><% date = evaluacion.fecha_de_evaluacion %>
        		<%= "#{date.day}-#{date.month}-#{date.year}" %>
        </td>
        <td><%= "#{evaluacion.user.name} #{evaluacion.user.lastname}" %></td>
        <td>Pendiente</td>
        <td><%= evaluacion.centro.nombre %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_evaluacion_path(evaluacion), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      evaluacion_path(evaluacion),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
          <%= link_to 'Generar PDF', '/evaluaciones/generate/'+evaluacion.id.to_s, :remote => true, :id => 'pdf_create_button'+evaluacion.id.to_s, :class => 'btn btn-mini' %>
          <%= link_to 'Download PDF', "/evaluaciones/download/#{evaluacion.id}", :id => 'pdf_download_button'+evaluacion.id.to_s, :class => 'btn btn-mini', :style => 'display: none;' %>

          <script>
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:loading',function(evt,data,status,xhr){

            }); 
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:success',function(evt,data,status,xhr){
              $('#pdf_download_button<%=evaluacion.id.to_s%>').fadeToggle();
              $('#pdf_create_button<%=evaluacion.id.to_s%>').fadeToggle();
            });
          </script>

        </td>
      </tr>
    <% end %>
	<% @enviadas.each do |evaluacion| %>
      <tr class="record" data-class= "evaluaciones" data-id="<%= evaluacion.id %>">
        <td><%= evaluacion.nombre_sala %></td>
        <td><% date = evaluacion.fecha_de_evaluacion %>
        		<%= "#{date.day}-#{date.month}-#{date.year}" %>
        </td>
        <td><%= "#{evaluacion.user.name} #{evaluacion.user.lastname}" %></td>
        <td>Enviada</td>
        <td><%= evaluacion.centro.nombre %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_evaluacion_path(evaluacion), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      evaluacion_path(evaluacion),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
          <%= link_to 'Generar PDF', '/evaluaciones/generate/'+evaluacion.id.to_s, :remote => true, :id => 'pdf_create_button'+evaluacion.id.to_s, :class => 'btn btn-mini' %>
          <%= link_to 'Download PDF', "/evaluaciones/download/#{evaluacion.id}", :id => 'pdf_download_button'+evaluacion.id.to_s, :class => 'btn btn-mini', :style => 'display: none;' %>

          <script>
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:loading',function(evt,data,status,xhr){

            }); 
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:success',function(evt,data,status,xhr){
              $('#pdf_download_button<%=evaluacion.id.to_s%>').fadeToggle();
              $('#pdf_create_button<%=evaluacion.id.to_s%>').fadeToggle();
            });
          </script>

        </td>
      </tr>
    <% end %>
	<% @completadas.each do |evaluacion| %>
      <tr class="record" data-class= "evaluaciones" data-id="<%= evaluacion.id %>">
        <td><%= evaluacion.nombre_sala %></td>
        <td><% date = evaluacion.fecha_de_evaluacion %>
        		<%= "#{date.day}-#{date.month}-#{date.year}" %>
        </td>
        <td><%= "#{evaluacion.user.name} #{evaluacion.user.lastname}" %></td>
        <td>Completada</td>
        <td><%= evaluacion.centro.nombre %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_evaluacion_path(evaluacion), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      evaluacion_path(evaluacion),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
          <%= link_to 'Generar PDF', '/evaluaciones/generate/'+evaluacion.id.to_s, :remote => true, :id => 'pdf_create_button'+evaluacion.id.to_s, :class => 'btn btn-mini' %>
          <%= link_to 'Download PDF', "/evaluaciones/download/#{evaluacion.id}", :id => 'pdf_download_button'+evaluacion.id.to_s, :class => 'btn btn-mini', :style => 'display: none;' %>

          <script>
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:loading',function(evt,data,status,xhr){

            }); 
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:success',function(evt,data,status,xhr){
              $('#pdf_download_button<%=evaluacion.id.to_s%>').fadeToggle();
              $('#pdf_create_button<%=evaluacion.id.to_s%>').fadeToggle();
            });
          </script>

        </td>
      </tr>
    <% end %>
  <% else %>
    <% @objetadas.each do |evaluacion| %>
      <tr class="record" data-class= "evaluaciones" data-id="<%= evaluacion.id %>">
        <td><%= evaluacion.nombre_sala %></td>
        <td><% date = evaluacion.fecha_de_evaluacion %>
        		<%= "#{date.day}-#{date.month}-#{date.year}" %>
        </td>
        <td><%= "#{evaluacion.user.name} #{evaluacion.user.lastname}" %></td>
        <td>Objetada</td>
        <td><%= evaluacion.centro.nombre %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_evaluacion_path(evaluacion), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      evaluacion_path(evaluacion),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
          <%= link_to 'Generar PDF', '/evaluaciones/generate/'+evaluacion.id.to_s, :remote => true, :id => 'pdf_create_button'+evaluacion.id.to_s, :class => 'btn btn-mini' %>
          <%= link_to 'Download PDF', "/evaluaciones/download/#{evaluacion.id}", :id => 'pdf_download_button'+evaluacion.id.to_s, :class => 'btn btn-mini', :style => 'display: none;' %>

          <script>
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:loading',function(evt,data,status,xhr){

            }); 
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:success',function(evt,data,status,xhr){
              $('#pdf_download_button<%=evaluacion.id.to_s%>').fadeToggle();
              $('#pdf_create_button<%=evaluacion.id.to_s%>').fadeToggle();
            });
          </script>

        </td>
      </tr>
    <% end %>
	<% @pendientes.each do |evaluacion| %>
      <tr class="record" data-class= "evaluaciones" data-id="<%= evaluacion.id %>">
        <td><%= evaluacion.nombre_sala %></td>
        <td><% date = evaluacion.fecha_de_evaluacion %>
        		<%= "#{date.day}-#{date.month}-#{date.year}" %>
        </td>
        <td><%= "#{evaluacion.user.name} #{evaluacion.user.lastname}" %></td>
        <td>Pendiente</td>
        <td><%= evaluacion.centro.nombre %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_evaluacion_path(evaluacion), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      evaluacion_path(evaluacion),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
          <%= link_to 'Generar PDF', '/evaluaciones/generate/'+evaluacion.id.to_s, :remote => true, :id => 'pdf_create_button'+evaluacion.id.to_s, :class => 'btn btn-mini' %>
          <%= link_to 'Download PDF', "/evaluaciones/download/#{evaluacion.id}", :id => 'pdf_download_button'+evaluacion.id.to_s, :class => 'btn btn-mini', :style => 'display: none;' %>

          <script>
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:loading',function(evt,data,status,xhr){

            }); 
            $("#pdf_create_button<%=evaluacion.id.to_s%>").bind('ajax:success',function(evt,data,status,xhr){
              $('#pdf_download_button<%=evaluacion.id.to_s%>').fadeToggle();
              $('#pdf_create_button<%=evaluacion.id.to_s%>').fadeToggle();
            });
          </script>

        </td>
      </tr>
    <% end %>
  <% end %>	
  </tbody>
</table>

<%= link_to t('.new', :default => t("helpers.links.new")),
            new_evaluacion_path,
            :class => 'btn btn-primary' %>
